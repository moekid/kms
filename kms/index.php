<?php
$sysList = [
    'Vista' => [
        'Windows Vista Business',
        'Windows Vista Business N',
        'Windows Vista Enterprise',
        'Windows Vista Enterprise N',
        'Windows Vista Business [Preview 1]',
        'Windows Vista Business [Preview 2]',
        'Windows Vista Business N [Preview]',
        'Windows Vista Enterprise [Preview 1]',
        'Windows Vista Enterprise [Beta-2 build 5384]'
    ],
    'Win 7' => [
        'Windows 7 Enterprise',
        'Windows 7 Enterprise E',
        'Windows 7 Enterprise N',
        'Windows 7 Professional',
        'Windows 7 Professional E',
        'Windows 7 Professional N',
        'Windows 7 Embedded POSReady',
        'Windows 7 Embedded Standard',
        'Windows 7 ThinPC'
    ],
    'Win 8' => [
        'Windows 8 Core / Server 2012',
        'Windows 8 Core / Server 2012 Country Specific',
        'Windows 8 Core / Server 2012 N',
        'Windows 8 Core / Server 2012 Single Language',
        'Windows 8 Professional WMC',
        'Windows 8 Embedded Industry Professional',
        'Windows 8 Embedded Industry Enterprise',
        'Windows 8 Enterprise',
        'Windows 8 Enterprise N',
        'Windows 8 Professional',
        'Windows 8 Professional N'
    ],
    'Win 8.1' => [
        'Windows 8.1 Core',
        'Windows 8.1 Core ARM64',
        'Windows 8.1 Core Country Specific',
        'Windows 8.1 Core N',
        'Windows 8.1 Core Single Language',
        'Windows 8.1 Professional Student',
        'Windows 8.1 Professional Student N',
        'Windows 8.1 Professional WMC',
        'Windows 8.1 Core Connected',
        'Windows 8.1 Core Connected Country Specific',
        'Windows 8.1 Core Connected N',
        'Windows 8.1 Core Connected Single Language',
        'Windows 8.1 Enterprise',
        'Windows 8.1 Enterprise N',
        'Windows 8.1 Professional',
        'Windows 8.1 Professional N',
        'Windows 8.1 Embedded Industry Professional',
        'Windows 8.1 Embedded Industry Automotive',
        'Windows 8.1 Embedded Industry Enterprise',
        'Windows 8.1 Enterprise [Preview]',
        'Windows 8.1 Professional (Blue) [Preview]',
        'Windows 8 Professional WMC [RC]',
        'Windows 8.x [Preview]'
    ],
    'Win 10' => [
        'Windows 10 Enterprise LTSC 2019',
        'Windows 10 Enterprise LTSC 2019 N',
        'Windows 10 Enterprise G',
        'Windows 10 Enterprise G N',
        'Windows 10 Enterprise 2016 LTSB',
        'Windows 10 Enterprise 2016 LTSB N',
        'Windows 10 Home / Core',
        'Windows 10 Home / Core Country Specific',
        'Windows 10 Home / Core N',
        'Windows 10 Home / Core Single Language',
        'Windows 10 Education',
        'Windows 10 Education N',
        'Windows 10 Enterprise',
        'Windows 10 Enterprise [Preview]',
        'Windows 10 Enterprise S',
        'Windows 10 Enterprise 2015 LTSB',
        'Windows 10 Enterprise 2015 LTSB N',
        'Windows 10 Enterprise N',
        'Windows 10 Enterprise S N',
        'Windows 10 Professional Workstation',
        'Windows 10 Professional Workstation N',
        'Windows 10 Professional',
        'Windows 10 Professional Education',
        'Windows 10 Professional Education N',
        'Windows 10 Professional N',
        'Windows 10 Professional [Preview]',
        'Windows 10 Professional WMC [Pre-Release]',
        'Windows 10 Enterprise for Virtual Desktops',
        'Windows 10 Remote Server',
        'Windows 10 S (Lean)',
        'Windows 10 IoT Core [Pre-Release]',
        'Windows 10 Core Connected [Pre-Release]',
        'Windows 10 Core Connected N [Pre-Release]',
        'Windows 10 Core Connected Single Language [Pre-Release]',
        'Windows 10 Core Connected Country Specific [Pre-Release]',
        'Windows 10 Professional S [Pre-Release]',
        'Windows 10 Professional S N [Pre-Release]',
        'Windows 10 Professional Student [Pre-Release]',
        'Windows 10 Professional Student N [Pre-Release]'
    ],
    'Server 2008' => [
        'Windows Server 2008 Web',
        'Windows Server 2008 HPC Edition',
        'Windows Server 2008 Standard',
        'Windows Server 2008 Standard without Hyper-V',
        'Windows Server 2008 Enterprise',
        'Windows Server 2008 Enterprise without Hyper-V',
        'Windows Server 2008 Datacenter',
        'Windows Server 2008 Datacenter without Hyper-V',
        'Windows Server 2008 for Itanium Systems',
        'Windows Server 2008 R2 Web',
        'Windows Server 2008 R2 HPC Edition',
        'Windows Server 2008 R2 Standard',
        'Windows Server 2008 R2 Enterprise',
        'Windows Server 2008 R2 Datacenter',
        'Windows Server 2008 R2 for Itanium Systems'
    ],
    'Server 2012' => [
        'Windows Server 2012 Datacenter',
        'Windows Server 2012 MultiPoint Premium',
        'Windows Server 2012 MultiPoint Standard',
        'Windows Server 2012 Standard',
        'Windows Server 2012 R2 Cloud Storage',
        'Windows Server 2012 R2 Datacenter',
        'Windows Server 2012 R2 Essentials',
        'Windows Server 2012 R2 Standard'
    ],
    'Server 2016' => [
        'Windows Server 2016 Azure Core',
        'Windows Server 2016 Cloud Storage',
        'Windows Server 2016 Datacenter',
        'Windows Server 2016 Essentials',
        'Windows Server 2016 Standard',
        'Windows Server 2016 ARM64',
        'Windows Server 2016 Datacenter (Semi-Annual Channel v.1803)',
        'Windows Server 2016 Standard (Semi-Annual Channel v.1803)',
        'Windows Server 2016 Datacenter [Preview]'
    ],
    'Server 2019' => [
        'Windows Server 2019 ARM64',
        'Windows Server 2019 Azure Core',
        'Windows Server 2019 Datacenter',
        'Windows Server 2019 Essentials',
        'Windows Server 2019 Standard',
        'Windows Server 2019 Datacenter (Semi-Annual Channel v.1809)',
        'Windows Server 2019 Standard (Semi-Annual Channel v.1809)',
        'Windows Server 2019 Standard [Preview]',
        'Windows Server 2019 Datacenter [Preview]'
    ],
    'Others' => [
        'Windows Server Next HI [Preview]',
        'Windows MultiPoint Server 2010',
        'Windows Longhorn Web [Preview]',
        'Windows Longhorn Standard',
        'Windows Longhorn Enterprise',
        'Windows Longhorn Datacenter [Preview]',
        'Windows Longhorn for Itanium Systems [Preview]'
    ]
];
?>

<!DOCTYPE HTML>
<html>

<head>
    <meta http-equiv="Content-Language" content="zh-cn">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>KMS激活Win系统</title>
    <link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">

    <style>
        body{
            background-image: url(kms.jpg);
            background-size: cover;
            background-repeat: no-repeat;
            background-attachment: fixed;
            color: #000000;
        }

        .container {
            margin-top: 40px;
        }
        
        .well {
            margin-bottom: 0;
            max-width: 700px;
            margin: auto;
        }
        
        #sys-tab{
            padding: 0 10px;
            max-height: calc(100vh - 500px);
            overflow: auto;
        }
        
        #sys-tab .tab-pane:not(.tip){
            min-height: 200px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="well">
                <div style="background: #f0f8e5;line-height:1;padding: 10px 10px 5px 10px;border-left: 3px solid #86cc00;margin-bottom: 10px;">
                    <p style="text-align: center;font-size: 20px;margin-bottom: 10px;border-bottom: 1px solid #d0cccc;padding-bottom: 6px;">
                        KMS激活Windows一键脚本
                    </p>
                    <p>1、激活步骤：根据自身系统下载激活脚本，再右键使用管理员运行该脚本即可。</p>
					<p>2、不知道系统版本的，使用Win+R，输入cmd并运行，然后在命令窗口输入slmgr/dlv查看版本。</p>
					<p>3、使用KMS激活系统后，有效期为180天。</p>
					<p>4、系统每7天会连接一次KMS服务器，获取最新的授权，然后激活有效期会重置为180天。</p>
					<p>5、只要KMS激活服务器不挂, 激活状态会一直自动续命，无需人工再次干预。</p>
					<p>6、如果激活失败可先尝试清除后激活，<a href="kms.php?clean">点击下载清除脚本</a>。</p>
                </div>
                <form action="./kms.php" method="get" role="form">
                    <ul class="nav nav-tabs" role="tablist">
                        <?php
                            foreach($sysList as $sysKey => $sysClass){
                                $temp = preg_replace('/[^0-9a-zA-Z]/', '-', $sysKey);
                                echo "<li role=\"presentation\"><a href=\"#win-$temp\" aria-controls=\"win-$temp\" role=\"tab\" data-toggle=\"tab\">$sysKey</a></li>";
                            }
                        ?>
                    </ul>
                    <div class="tab-content" id="sys-tab">
                        <div role="tabpanel" class="tab-pane tip active">
                            <h4 style="text-align:center">请从上方选择需要激活的系统</h4>
                        </div>
                        <?php
                            foreach($sysList as $sysKey => $sysClass){
                                $temp = preg_replace('/[^0-9a-zA-Z]/', '-', $sysKey);
                                echo "<div role=\"tabpanel\" class=\"tab-pane\" id=\"win-$temp\">";
                                foreach($sysClass as $sysName){
                                    echo "<div class=\"radio\"><label><input type=\"radio\" name=\"kms\" value=\"$sysName\">$sysName</label></div>";
                                }
                                echo "</div>";
                            }
                        ?>
                    </div>
                    <br />
                    <button type="submit" class="btn btn-success btn-block">生成激活脚本</button>
                    <br />
                    <div style="background: #f0f8e5;line-height: 1;padding: 10px;border-left: 3px solid #86cc00;">
                        KMS服务器提供：<a href="https://moeclub.org" target="_blank">萌咖</a>；界面美化：<a href="https://mikuac.com" target="_blank">Zero</a>、<a href="https://lolico.moe/" target="_blank">綺凜</a>；本站由 <a href="https://www.moerats.com" target="_blank">Rat's博客</a>
                        提供维护和技术支持！
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
    <script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
</body>

</html>
